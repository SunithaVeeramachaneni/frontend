<ion-header className="nav-header">
  <ion-toolbar>
    <app-header [title]="headerTitle"></app-header>
    <ion-row>
      <ion-col class="maintenance-header">
          <!-- <ion-searchbar placeholder="Search Work Orders" [formControl]="filter" class="searchbar" disabled></ion-searchbar>       -->        
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">
                <i class="fa fa-search" aria-hidden="true"></i>
              </span>
            </div>
            <input type="text" placeholder="Search" aria-label="Search"style="border:1px solid #F2F2F2; opacity: 0.75; background:#F2F2F2;">
            <div class="input-group-prepend">
              <span class="input-group-text">
                <ion-img [src]="filterIcon"
                         [popover]="popTemplate"
                         [placement]="'bottom'"
                         [container]="'body'"
                         #pop="bs-popover"></ion-img>
              </span>
            </div>
          </div>

          <ng-template #popTemplate>
            <form #form="ngForm">
              <mat-form-field appearance="outline" class="mat-field">
                <mat-label>Show Overdue</mat-label>
                <mat-select [formControl]="overdueFilter" name="showOverdue" [(ngModel)]="showOverdue">
                  <mat-option *ngFor="let showdue of showOverdueList" [value]="showdue">
                    {{showdue}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="mat-field">
                <mat-label>Priority</mat-label>
                <mat-select name="priority" multiple [(ngModel)]="priority">
                  <mat-option *ngFor="let prioritizedItem of priorityList" [value]="prioritizedItem">{{prioritizedItem}}</mat-option>
                </mat-select>
              </mat-form-field>
    
              <mat-form-field appearance="outline" class="mat-field">
                <mat-label>Kitting Status</mat-label>
                <mat-select name="kitStatus" multiple [(ngModel)]="kitStatus">
                  <mat-option *ngFor="let kit of kitStatusList" [value]="kit">{{kit}}</mat-option>
                </mat-select>
              </mat-form-field>
    
              <mat-form-field appearance="outline" class="mat-field">
                <mat-label>Work Center</mat-label>
                <mat-select name="workCenter" multiple [(ngModel)]="workCenter">
                  <mat-option *ngFor="let workCenterItem of workCenterList" [value]="workCenterItem">{{workCenterItem}}</mat-option>
                </mat-select>
              </mat-form-field>
    
              <mat-form-field appearance="outline" class="mat-field" *ngIf="workCenter != ''">
                <mat-label>Assignee</mat-label>
                <mat-select name="assign" multiple [(ngModel)]="assign">
                  <mat-option *ngFor="let assigned of assignList" [value]="assigned">{{assigned}}</mat-option>
                </mat-select>
              </mat-form-field> 

              <br/>
              <button class="btn apply-filters-btn" (click)="pop.hide()">Apply</button>
              <button (click)="form.reset()" class="reset-filters-btn">Reset</button>
              
            </form>
          </ng-template>

          <ion-segment value="today" [formControl]="selectDate" mode="ios"  class="segment-group">
            <ion-segment-button value="today" class="segment-button">
              <ion-label>Due Today</ion-label>
            </ion-segment-button>
            <hr class="segmented-line"/>
            <ion-segment-button value="week" class="segment-button">
              <ion-label>Due This Week</ion-label>
            </ion-segment-button>
            <hr class="segmented-line"/>
            <ion-segment-button value="month" class="segment-button">
              <ion-label>Due This Month</ion-label>
            </ion-segment-button>
            <hr class="segmented-line"/>
            <ion-segment-button value="custom" class="segment-button" disabled>
              <ion-label>Custom</ion-label>
            </ion-segment-button>
          </ion-segment>
      </ion-col>
    </ion-row>
</ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true">

  <ion-row *ngIf="this.filteredWorkOrderList$ | async as workOrders">
    <ion-col size-lg="3" size-md="3" size-sm="3">
      <ion-list class="unassigned-workorder-list">
        <ion-item>
          <ion-label>
            <span class="kits-count">{{workOrders.unassigned.length}}</span>
            <br>
            <span class="kit-heading">Unassigned Work Orders</span>
          </ion-label>
        </ion-item>
        <ion-item lines="none" *ngFor="let workOrder of workOrders.unassigned; let i = index;">
          <ion-label>
            <span *ngIf="workOrder.priorityStatus==='Very high' || workOrder.priorityStatus==='High'" class="high-priority">HIGH</span>
            <span *ngIf="workOrder.priorityStatus==='Medium'" class="medium-priority">MEDIUM</span>
            <span *ngIf="workOrder.priorityStatus==='Low'" class="low-priority">LOW</span>
            <span class="kit-ready">KIT READY</span>
            <br/>
            <span class="kit-number">{{workOrder.workOrderID}} - {{workOrder.workOrderDesc}}</span><br>
            <span class="display-flex">
              <ion-img [src]="dataIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="dateIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="timeIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.estimatedTime}}</span>
            </span>

            <ion-button (click)="openModal()" color="light" expand="full"> 
              <ion-img [src]="assignIcon" class="assign-btn-icon"></ion-img>
              <span class="assign-btn-text">ASSIGN</span> 
            </ion-button>

          
            <ion-button expand="full" fill="clear" (click)="showOperations('unassigned', i)" class="show-operations-btn" *ngIf="this.showOperationsList.unassigned[i] === false">
              <ion-icon name="chevron-down-outline" class="down-up-arrow"></ion-icon> Show {{workOrder.operations.length}} Operations
            </ion-button>
            <ion-button expand="full" fill="clear" (click)="showOperations('unassigned', i)" class="show-operations-btn" *ngIf="this.showOperationsList.unassigned[i] === true">
              <ion-icon name="chevron-up-outline" class="down-up-arrow"></ion-icon> Hide {{workOrder.operations.length}} Operations
            </ion-button>
            <hr *ngIf="this.showOperationsList.unassigned[i] === true" class="operations-line"/>
            <span>
              <div *ngIf="this.showOperationsList.unassigned[i] === true" class="operations-div">
                <ion-item class="operations-list" *ngFor="let operation of workOrders.unassigned[i].operations; let j = index;">
                  <ion-label>
                    <span class="kit-number">Operation</span><br>
                    <span class="display-flex">
                      <ion-img [src]="dataIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="dateIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="timeIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{operation.ARBEI | number }} hrs</span>
                    </span>

                    <!-- <span>
                      <ion-button shape="round" color="light">
                        <ion-img [src]="assignIcon" class="assign-btn-icon"></ion-img>
                      </ion-button>
                    </span> -->
                  </ion-label>
                </ion-item>
              </div>
            </span>

          </ion-label>           
        </ion-item>
       
      </ion-list>
    </ion-col>
    <ion-col size-lg="3" size-md="3" size-sm="3">
      <ion-list class="assigned-workorder-list">
        <ion-item>
          <ion-label>
            <span class="kits-count">{{workOrders.assigned.length}}</span>
            <br>
            <span class="kit-heading">Assigned Work Orders</span>
          </ion-label>
        </ion-item>
        <ion-item lines="none" *ngFor="let workOrder of workOrders.assigned; let i = index;">
          <ion-label>
            <span *ngIf="workOrder.priorityStatus==='Very high' || workOrder.priorityStatus==='High'" class="high-priority">HIGH</span>
            <span *ngIf="workOrder.priorityStatus==='Medium'" class="medium-priority">MEDIUM</span>
            <span *ngIf="workOrder.priorityStatus==='Low'" class="low-priority">LOW</span>
            <span class="kit-ready">KIT READY</span>
            <br/>
            <span class="kit-number">{{workOrder.workOrderID}} - {{workOrder.workOrderDesc}}</span><br>
            <span class="display-flex">
              <ion-img [src]="dataIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="dateIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="timeIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.estimatedTime}}</span>
            </span>
 
            <ion-button expand="full" fill="clear" (click)="showOperations('assigned', i)" class="show-operations-btn" *ngIf="this.showOperationsList.assigned[i] === false">
              <ion-icon name="chevron-down-outline" class="down-up-arrow"></ion-icon> Show {{workOrder.operations.length}} Operations
            </ion-button>
            <ion-button expand="full" fill="clear" (click)="showOperations('assigned', i)" class="show-operations-btn" *ngIf="this.showOperationsList.assigned[i] === true">
              <ion-icon name="chevron-up-outline" class="down-up-arrow"></ion-icon> Hide {{workOrder.operations.length}} Operations
            </ion-button>
            <hr *ngIf="this.showOperationsList.assigned[i] === true" class="operations-line"/>
            <span>
              <div *ngIf="this.showOperationsList.assigned[i] === true" class="operations-div">
                <ion-item class="operations-list" *ngFor="let operation of workOrders.assigned[i].operations; let j = index;">
                  <ion-label>
                    <span class="kit-number">Operation</span><br>
                    <span class="display-flex">
                      <ion-img [src]="dataIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="dateIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="timeIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{operation.ARBEI | number }} hrs</span>
                    </span>

                    <!-- <span>
                      <ion-button shape="round" color="light">
                        <ion-img [src]="assignIcon" class="assign-btn-icon"></ion-img>
                      </ion-button>
                    </span> -->
                  </ion-label>
                </ion-item>
              </div>
            </span>
          </ion-label>        
        </ion-item>
       </ion-list>
    </ion-col>
    <ion-col size-lg="3" size-md="3" size-sm="3">
      <ion-list class="in-progress-workorder-list">
        <ion-item>
          <ion-label>
            <span class="kits-count">{{workOrders.inProgress.length}}</span>
            <br>
            <span class="kit-heading">In Progress</span>
          </ion-label>
        </ion-item>
        <ion-item lines="none" *ngFor="let workOrder of workOrders.inProgress; let i = index;">
          <ion-label>
            <span *ngIf="workOrder.priorityStatus==='Very high' || workOrder.priorityStatus==='High'" class="high-priority">HIGH</span>
            <span *ngIf="workOrder.priorityStatus==='Medium'" class="medium-priority">MEDIUM</span>
            <span *ngIf="workOrder.priorityStatus==='Low'" class="low-priority">LOW</span>
            <br/>
            <span class="kit-number">{{workOrder.workOrderID}} - {{workOrder.workOrderDesc}}</span><br>
            <span class="display-flex">
              <ion-img [src]="dataIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="dateIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="timeIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.estimatedTime}}</span>
            </span>

            <span>
               <select class="form-control form-control-sm" [(ngModel)]="this.selectedUser">
                 <option value="Amy Butcher">Amy Butcher</option>
                 <option value="Carlos Arnal">Carlos Arnal </option>
                 <option value="Steve Austin">Steve Austin</option>
               </select>   
            </span>

            <ion-button expand="full" fill="clear" (click)="showOperations('inProgress', i)" class="show-operations-btn" *ngIf="this.showOperationsList.inProgress[i] === false">
              <ion-icon name="chevron-down-outline" class="down-up-arrow"></ion-icon> Show {{workOrder.operations.length}} Operations
            </ion-button>
            <ion-button expand="full" fill="clear" (click)="showOperations('inProgress', i)" class="show-operations-btn" *ngIf="this.showOperationsList.inProgress[i] === true">
              <ion-icon name="chevron-up-outline" class="down-up-arrow"></ion-icon> Hide {{workOrder.operations.length}} Operations
            </ion-button>
            <hr *ngIf="this.showOperationsList.inProgress[i] === true" class="operations-line"/>
            <span>
              <div *ngIf="this.showOperationsList.inProgress[i] === true" class="operations-div">
                <ion-item class="operations-list" *ngFor="let operation of workOrders.inProgress[i].operations; let j = index;">
                  <ion-label>
                    <span class="kit-number">Operation</span><br>
                    <span class="display-flex">
                      <ion-img [src]="dataIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="dateIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="timeIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{operation.ARBEI | number }} hrs</span>
                    </span>

                    <!-- <span>
                      <ion-button shape="round" color="light">
                        <ion-img [src]="assignIcon" class="assign-btn-icon"></ion-img>
                      </ion-button>
                    </span> -->
                  </ion-label>
                </ion-item>
              </div>
            </span>
          </ion-label>        
        </ion-item>
       </ion-list>
    </ion-col>
    <ion-col size-lg="3" size-md="3" size-sm="3">
      <ion-list class="completed-workorder-list">
        <ion-item>
          <ion-label>
            <span class="kits-count">{{workOrders.completed.length}}</span>
            <br>
            <span class="kit-heading">Completed</span>
          </ion-label>
        </ion-item>
        <ion-item lines="none" *ngFor="let workOrder of workOrders.completed; let i = index;">
          <ion-label>
            <span *ngIf="workOrder.priorityStatus==='Very high' || workOrder.priorityStatus==='High'" class="high-priority">HIGH</span>
            <span *ngIf="workOrder.priorityStatus==='Medium'" class="medium-priority">MEDIUM</span>
            <span *ngIf="workOrder.priorityStatus==='Low'" class="low-priority">LOW</span>
            <br/>
            <span class="kit-number">{{workOrder.workOrderID}} - {{workOrder.workOrderDesc}}</span><br>
            <span class="display-flex">
              <ion-img [src]="dataIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="dateIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
            </span>
            <span class="display-flex">
              <ion-img [src]="timeIcon" class="list-icons"></ion-img>
              <span class="date-priority-label">{{workOrder.estimatedTime}}</span>
            </span>

            <span>
               <select class="form-control form-control-sm" [(ngModel)]="this.selectedUser">
                 <option value="Amy Butcher">Amy Butcher</option>
                 <option value="Carlos Arnal">Carlos Arnal </option>
                 <option value="Steve Austin">Steve Austin</option>
               </select>   
            </span>

            <ion-button expand="full" fill="clear" (click)="showOperations('completed', i)" class="show-operations-btn" *ngIf="this.showOperationsList.completed[i] === false">
              <ion-icon name="chevron-down-outline" class="down-up-arrow"></ion-icon> Show {{workOrder.operations.length}} Operations
            </ion-button>
            <ion-button expand="full" fill="clear" (click)="showOperations('completed', i)" class="show-operations-btn" *ngIf="this.showOperationsList.completed[i] === true">
              <ion-icon name="chevron-up-outline" class="down-up-arrow"></ion-icon> Hide {{workOrder.operations.length}} Operations
            </ion-button>
            <hr *ngIf="this.showOperationsList.completed[i] === true" class="operations-line"/>
            <span>
              <div *ngIf="this.showOperationsList.completed[i] === true" class="operations-div">
                <ion-item class="operations-list" *ngFor="let operation of workOrders.completed[i].operations; let j = index;">
                  <ion-label>
                    <span class="kit-number">Operation</span><br>
                    <span class="display-flex">
                      <ion-img [src]="dataIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.equipmentID}} - {{workOrder.equipmentName}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="dateIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{workOrder.dueDate | date: 'd-MMM-yy'}}</span>
                    </span>
                    <span class="display-flex">
                      <ion-img [src]="timeIcon" class="list-icons"></ion-img>
                      <span class="date-priority-label">{{operation.ARBEI | number }} hrs</span>
                    </span>

                    <!-- <span>
                      <ion-button shape="round" color="light">
                        <ion-img [src]="assignIcon" class="assign-btn-icon"></ion-img>
                      </ion-button>
                    </span> -->
                  </ion-label>
                </ion-item>
              </div>
            </span>
          </ion-label>        
        </ion-item>
       </ion-list>
      </ion-col>
  </ion-row> 
</ion-content>
