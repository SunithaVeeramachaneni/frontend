<div class="rdf-forms-list-screen">
  <div class="dis-flex" [formGroup]="searchForm">
    <div class="width-90 search-box">
      <mat-form-field class="width-100" appearance="outline">
        <input
          matInput
          placeholder="Search"
          class="width-100"
          autocomplete="off"
          formControlName="search"
        />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
    <div class="width-10">
      <button [disabled]="true" class="filter-btn">
        <span class="filter-text"> Filter </span>
        <img
          src="../../../assets/rdf-forms-icons/filter-icon.svg"
          alt="filter-icon"
          class="filter-icon"
        />
      </button>
    </div>
  </div>
  <div class="dis-flex">
    <h1 class="recent-forms-heading">Recent Forms</h1>

    <mat-button-toggle-group>
      <mat-button-toggle [routerLink]="['/rdf-forms/create']">
        <span class="data"> Create Form </span>
      </mat-button-toggle>
      <mat-button-toggle [matMenuTriggerFor]="menu" aria-label="More Options">
        <img src="assets/work-instructions-icons/svg/dropdown.svg" alt="" />
      </mat-button-toggle>
    </mat-button-toggle-group>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="uploader.click()">
        <span class="dropdown-item-title">Import File</span>
        <input
          id="upload"
          hidden
          type="file"
          #uploader
          accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,audio/*,video/*"
          (change)="uploadFile($event)"
          (click)="resetFile($event)"
        />
      </button>
    </mat-menu>
  </div>
  <div
    class="formsListContainer"
    *ngIf="formsData$ | async as forms; else loadingForms"
    (scroll)="onFormsListScrolled($event)"
  >
    <div *ngFor="let form of forms.data" class="forms-list">
      <div class="form-data">
        <span (click)="editForm(form)">
          <span class="form-name">{{ form.name }}</span>
          <br />
          <span class="form-description">{{ form.description }}</span>
        </span>

        <button
          [matMenuTriggerFor]="sectionMenu"
          class="more-icon"
          [ngClass]="{ 'more-icon-mt': form.description.trim() }"
          aria-label="More Options"
        >
          <mat-icon>more_horiz</mat-icon>
        </button>
        <mat-menu #sectionMenu="matMenu">
          <button mat-menu-item (click)="editForm(form)">
            <span>Edit</span>
          </button>
          <button mat-menu-item (click)="duplicateForm(form)">
            <span>Copy</span>
          </button>
          <button mat-menu-item (click)="deleteForm(form)" class="text-red">
            <span>Delete</span>
          </button>
        </mat-menu>
        <span
          class="time-ago"
          [ngClass]="{ 'time-ago-mt': form.description.trim() }"
        >
          <span class="form-created">
            <ng-container *ngIf="form?.updatedAt; else createdAt">
              {{ form?.updatedAt | timeAgo }}
            </ng-container>
            <ng-template #createdAt>
              {{ form?.createdAt | timeAgo }}
            </ng-template>
            <span *ngIf="form?.updatedBy">by {{ form?.updatedBy }}</span>
          </span>
          <div></div>
        </span>
      </div>
    </div>
    <div class="dis-flex no-records white-bg" *ngIf="forms.data.length === 0">
      No results
    </div>
  </div>
</div>

<ng-template #loadingForms>
  <div class="forms-list-loader">
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'">
    </ngx-shimmer-loading>
  </div>
</ng-template>
