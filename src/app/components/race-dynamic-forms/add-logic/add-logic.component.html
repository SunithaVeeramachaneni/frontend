<div [formGroup]="logicsForm">
  <mat-tab-group formArrayName="logics">
    <mat-tab
      *ngFor="let logic of getLogicsList(); let i = index"
      label="{{ logic.value.logicTitle ? logic.value.logicTitle : 'Untitled' }}"
    >
      <div class="tabContent" [formGroupName]="i">
        <div>
          <input type="hidden" formControlName="logicTitle" />
          <input type="hidden" formControlName="expression" />
          If answer
          <select
            class="logicCondition"
            formControlName="operator"
            (ngModelChange)="operatorChanged(logic, $event)"
          >
            <option
              value="{{ operator.code }}"
              *ngFor="let operator of fieldOperators"
            >
              {{ operator.displayName }}
            </option>
          </select>
          <input
            type="text"
            class="logicValue"
            formControlName="operand2"
            (ngModelChange)="operand2Changed(logic, $event)"
          />
          then
          <input
            *ngIf="logic.value.action"
            formControlName="action"
            class="action"
            readonly
          />
          <button mat-button [matMenuTriggerFor]="menu" color="primary">
            +trigger
          </button>
          <mat-menu #menu="matMenu">
            <button
              mat-menu-item
              (click)="triggerMenuAction('ask_questions', logic)"
            >
              Ask Questions
            </button>
            <button mat-menu-item (click)="triggerMenuAction('hide', logic)">
              Hide Questions
            </button>
            <button
              mat-menu-item
              (click)="triggerMenuAction('ask_evidence', logic)"
            >
              Ask Evidence
            </button>
          </mat-menu>
          <input
            readonly
            formControlName="expression"
            class="action"
            *ngIf="logic.value.action"
          />
        </div>

        <div
          *ngIf="logic.value.action === 'Ask Questions'"
          class="logicAskQuestions"
        >
          <h4>Asking Questions</h4>
        </div>
      </div>
      <b>{{ logic.value | json }}</b>
    </mat-tab>
  </mat-tab-group>
</div>
