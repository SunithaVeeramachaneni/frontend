<div [formGroup]="logicsForm">
  <mat-tab-group formArrayName="logics">
    <mat-tab
      *ngFor="let logic of getLogicsList(); let i = index"
      label="{{ logic.value.logicTitle ? logic.value.logicTitle : 'Untitled' }}"
    >
      <div class="tabContent" [formGroupName]="i">
        <div class="logicRow">
          <input type="hidden" formControlName="logicTitle" />
          <input type="hidden" formControlName="expression" />
          If answer
          <select
            class="logicCondition"
            formControlName="operator"
            (ngModelChange)="operatorChanged(logic, $event)"
          >
            <option
              class="logicOperator"
              value="{{ operator.code }}"
              *ngFor="let operator of fieldOperators"
            >
              {{ operator.displayName }}
            </option>
          </select>
          <input
            type="text"
            class="logicValue"
            formControlName="operand2"
            (ngModelChange)="operand2Changed(logic, $event)"
          />
          then
          <input
            *ngIf="logic.value.action"
            formControlName="action"
            class="action"
            readonly
          />
          <span
            *ngIf="
              logic.value.mandateQuestions &&
              logic.value.mandateQuestions.length
            "
            class="mandateAction"
            (click)="openSelectQuestionsDialog(question, logic, 'MANDATE')"
          >
            Mandate Questions <mat-icon>edit</mat-icon>
          </span>
          <span
            *ngIf="
              logic.value.hideQuestions && logic.value.hideQuestions.length
            "
            class="mandateAction"
            (click)="openSelectQuestionsDialog(question, logic, 'HIDE')"
          >
            Hide Questions <mat-icon>edit</mat-icon>
          </span>
          <button mat-button [matMenuTriggerFor]="menu" class="actionBtn">
            + action
          </button>
          <mat-menu #menu="matMenu">
            <button
              mat-menu-item
              (click)="triggerMenuAction('ask_questions', logic)"
              disabled
              [hidden]="true"
            >
              Ask Questions
            </button>
            <button
              mat-menu-item
              (click)="openSelectQuestionsDialog(question, logic, 'MANDATE')"
            >
              Mandate Questions
            </button>
            <button
              mat-menu-item
              (click)="openSelectQuestionsDialog(question, logic, 'HIDE')"
            >
              Hide Questions
            </button>
            <button
              mat-menu-item
              (click)="triggerMenuAction('ask_evidence', logic)"
            >
              Ask Evidence
            </button>
          </mat-menu>
          <!-- <input
            readonly
            formControlName="expression"
            class="action expression"
            *ngIf="logic.value.action"
          /> -->
        </div>
        <div
          *ngIf="logic.value.action === 'Ask Questions'"
          class="logicAskQuestions"
        >
          <app-ask-question
            [logic]="logic"
            (onValueChanged)="onLogicQuestionValueChanged(logic, $event)"
          ></app-ask-question>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
