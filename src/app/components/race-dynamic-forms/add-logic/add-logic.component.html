<div [formGroup]="logicsForm">
  <mat-tab-group formArrayName="logics">
    <mat-tab
      *ngFor="let logic of getLogicsList(); let i = index"
      label="{{ logic.value.logicTitle ? logic.value.logicTitle : 'Untitled' }}"
    >
      <div class="tabContent" [formGroupName]="i">
        <div class="logicRow">
          <img
            src="assets/rdf-forms-icons/delete-icon.svg"
            alt="delete-icon"
            class="delete-icon"
            (click)="deleteLogic(logic, i)"
          />
          <input type="hidden" formControlName="logicTitle" />
          <input type="hidden" formControlName="expression" />
          <input type="hidden" formControlName="askEvidence" />
          If answer

          <select
            class="logicCondition"
            formControlName="operator"
            (ngModelChange)="operatorChanged(logic, $event)"
          >
            <option
              class="logicOperator"
              value="{{ operator.code }}"
              *ngFor="let operator of fieldOperators"
            >
              {{ operator.displayName }}
            </option>
          </select>
          <input
            *ngIf="dropDownTypes.indexOf(question.value.fieldType) < 0"
            type="text"
            class="logicValue"
            formControlName="operand2"
            (ngModelChange)="operand2Changed(logic, $event)"
          />
          <select
            class="logicValue"
            stype="margin-left: -30px;"
            formControlName="operand2"
            *ngIf="dropDownTypes.indexOf(question.value.fieldType) > -1"
          >
            <option
              class="logicOperator"
              *ngFor="let option of question.value.value.values"
            >
              {{ option.title }}
            </option>
          </select>
          then
          <span
            *ngIf="
              logic.value.mandateQuestions &&
              logic.value.mandateQuestions.length
            "
            class="mandateAction"
            (click)="openSelectQuestionsDialog(question, logic, 'MANDATE')"
          >
            Mandate ({{ logic.value.mandateQuestions.length }}) Questions
            <mat-icon>edit</mat-icon>
          </span>
          <span
            *ngIf="
              logic.value.hideQuestions && logic.value.hideQuestions.length
            "
            class="mandateAction"
            (click)="openSelectQuestionsDialog(question, logic, 'HIDE')"
          >
            Hide ({{ logic.value.hideQuestions.length }}) Questions
            <mat-icon>edit</mat-icon>
          </span>
          <span *ngIf="logic.value.requireEvidence" class="mandateAction">
            Ask Evidence
            <mat-icon (click)="removeEvidence(logic)">close</mat-icon>
          </span>
          <button mat-button [matMenuTriggerFor]="menu" class="actionBtn">
            + action
          </button>
          <mat-menu #menu="matMenu">
            <button
              class="logicActionMenuItem"
              mat-menu-item
              (click)="triggerMenuAction('ask_questions', logic)"
              disabled
              [hidden]="true"
            >
              Ask Questions
            </button>
            <button
              class="logicActionMenuItem"
              mat-menu-item
              (click)="openSelectQuestionsDialog(question, logic, 'MANDATE')"
            >
              Mandate Questions
            </button>
            <button
              class="logicActionMenuItem"
              mat-menu-item
              (click)="openSelectQuestionsDialog(question, logic, 'HIDE')"
            >
              Hide Questions
            </button>
            <button
              mat-menu-item
              class="logicActionMenuItem"
              (click)="askEvidence(logic)"
            >
              Ask Evidence
            </button>
          </mat-menu>
          <!-- <input
            readonly
            formControlName="expression"
            class="action expression"
            *ngIf="logic.value.action"
          /> -->
        </div>
        <div
          *ngIf="logic.value.action === 'Ask Questions'"
          class="logicAskQuestions"
        >
          <app-ask-question
            [logic]="logic"
            (onValueChanged)="onLogicQuestionValueChanged(logic, $event)"
          ></app-ask-question>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
