<div class="min-app">
  <img src="assets/img/svg/small_screen.svg" /><br />
  Please use a tablet or desktop for the best connected worker experience
</div>

<mat-sidenav-container class="main-app">
  <mat-sidenav
    #sidenav
    mode="side"
    opened
    [ngClass]="{
      'hide-content': isUserAuthenticated === false,
      'menu-close': !menuOpenClose
    }"
  >
    <div class="sidebar-menu-items">
      <mat-nav-list
        class="menu-item"
        *ngFor="let menuitem of menus; let i = index"
      >
        <li
          routerLinkActive="selected"
          routerDirection="root"
          title="{{ menuitem.title }}"
          *appCheckUserHasPermission="[menuitem.permission]; else loadingMenu"
          class="dis-flex"
        >
          <a
            mat-list-item
            class="menu-name"
            [routerLink]="menuitem.url"
            routerLinkActive="active"
            (click)="selectedListElement(menuitem.title)"
          >
            <img
              [src]="
                getImage(menuitem.imageName, selectedMenu === menuitem.title)
              "
              class="sidebar-icons"
            />
            <span class="menu-title" *ngIf="menuOpenClose">
              {{ menuitem.title }}
            </span>
          </a>
          <ng-container *ngIf="userInfo$ | async as userInfo">
            <ng-container
              *ngIf="
                checkUserHasSubMenusPermissions(
                  userInfo.permissions,
                  menuitem.subPages,
                  menuitem.permission
                )
              "
            >
              <a
                *ngIf="menuitem.subPages !== null && menuOpenClose"
                class="arrow-margin"
                (click)="menuitem.showSubMenu = !menuitem.showSubMenu"
              >
                <img
                  src="assets/sidebar-icons/right-arrow.svg"
                  [hidden]="menuitem.showSubMenu === true"
                />
                <img
                  src="assets/sidebar-icons/down-arrow.svg"
                  [hidden]="menuitem.showSubMenu === false"
                />
              </a>
            </ng-container>
          </ng-container>
        </li>

        <div
          *ngIf="
            menuitem.showSubMenu && menuitem.subPages !== null && menuOpenClose
          "
          class="m-l-70"
        >
          <ng-container *ngIf="userInfo$ | async as userInfo">
            <ng-container
              *ngIf="
                checkUserHasSubMenusPermissions(
                  userInfo.permissions,
                  menuitem.subPages,
                  menuitem.permission
                )
              "
            >
              <ul
                lines="none"
                class="p-0 m-0"
                *ngFor="let submenuitem of menuitem.subPages"
              >
                <a
                  class="submenu m-0"
                  mat-list-item
                  [routerLink]="submenuitem.url"
                  routerLinkActive="subSelected"
                  *appCheckUserHasPermission="[submenuitem.permission]"
                  (click)="selectedListElement(submenuitem.title)"
                >
                  <span>{{ submenuitem.title }}</span>
                </a>
              </ul>
            </ng-container>
          </ng-container>
        </div>
      </mat-nav-list>
    </div>
    <img
      src="{{ bigInnovaIcon }}"
      [hidden]="!menuOpenClose"
      class="innov-big-img"
    />
    <img
      src="{{ smallInnovaIcon }}"
      [hidden]="menuOpenClose"
      class="innov-small-img"
    />
  </mat-sidenav>

  <mat-sidenav-content>
    <app-header
      (sideNavToggle)="toggleMenu()"
      (outsideClickTrigger)="closeSideNav()"
      [selectedMenu]="this.selectedMenu"
      [ngClass]="{
        'hide-content': isUserAuthenticated === false
      }"
    ></app-header>

    <main
      (click)="closeSideNav()"
      [ngClass]="{
        'show-content': this.currentRouteUrl !== '/login',
        'show-login':
          this.currentRouteUrl === '/login' || isUserAuthenticated === false
      }"
    >
      <router-outlet>
        <ngx-shimmer-loading
          *ngIf="displayLoader$ | async"
          [width]="'100%'"
          [height]="'100%'"
        ></ngx-shimmer-loading>
      </router-outlet>
    </main>
  </mat-sidenav-content>
</mat-sidenav-container>
<ng-template #loadingMenu>
  <ngx-shimmer-loading
    [width]="'55%'"
    [height]="'40px'"
    class="sidebar-loader"
  ></ngx-shimmer-loading>
</ng-template>
